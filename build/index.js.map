{"version":3,"sources":["../../webpack/universalModuleDefinition","../../webpack/bootstrap","Component.js","Emitter.js","Recursion.js","Engine.js","Node.js","View/Drag.js","View/Area.js","View/Connection.js","View/Socket.js","View/Element.js","View/Node.js","View/Picker.js","View/Selection.js","View/index.js","Editor.js","index.js"],"names":["root","factory","exports","module","define","amd","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Component","Emitter","events","event","cb","push","filter","args","forEach","Recursion","nodes","targetNode","node","outputs","length","reduce","acc","Array","isArray","indexOf","id","inputNodes","array2","inters","inter","findSelf","extractInputNode","process","nodeselected","nodecreate","nodecreated","noderemove","noderemoved","nodetranslated","connectionselected","connectioncreated","connectionremoved","contextmenu","Engine","version","component","Error","engine","components","data","recurrentNode","detect","input","undefined","output","type","worker","_","outputNodeIds","idx","nextInput","nodeId","nextNode","find","forwardProcess","startId","json","validate","emit","Node","options","position","metadata","branch","result","map","out","complete","Drag","element","onTranslate","onStart","onStop","hotkey","pointerStart","down","keyDown","keyUp","move","up","removeEventListener","addEventListener","keypress","window","code","style","cursor","pointerType","stopPropagation","pageX","pageY","preventDefault","y","delta","zoom","getBoundingClientRect","width","offsetWidth","Area","container","mouse","x","document","createElement","transformOrigin","background","className","zIndex","appendChild","pointermove","_drag","transform","z","update","clientX","clientY","rect","left","top","e","_startPosition","dx","dy","translate","tf","contains","removeChild","Connection","view","outputSocket","inputSocket","emitter","addConnection","pointerEvents","keyup","_path","area","render","on","self","vm","listener","click","points","x1","y1","x2","y2","dx1","dy1","dx2","dy2","defaultPath","path","querySelector","paths","querySelectorAll","setAttribute","connection","svg","createElementNS","path_l","path_ol","path_bg","classes","inputId","outputId","classList","add","getPosition","renderPathData","getPoints","updateConnection","renderConnection","nodeView","toggle","destroy","removeConnection","Socket","pointerdown","_pick","socket","picker","reset","pickInput","pickOutput","dispatchEvent","PointerEvent","action","exist","conn","index","splice","el","center","offsetHeight","offsetLeft","offsetTop","Element","content","innerHTML","sockets","selected","remove","keys","addSocket","addOutput","rerenderNode","_e","selectNode","ctrlKey","params","Math","floor","toJSON","Picker","_socket","pointerup","endEl","elementFromPoint","getSockets","hasConnection","connect","updatePseudoConnection","Selection","_endPosition","defaultPrevented","selection","direction","getElement","bounding","clientWidth","clientHeight","renderPath","overflow","View","addNode","removeNode","NodeView","builder","accumulate","focus","deletedNode","from","fromBranch","to","toBranch","fromNode","toNode","fromSocket","getSocket","toSocket","connKey","removeOutput","collision","target","Editor","rand","random","toString","substr","findIndex","getNode"],"mappings":"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","file":"index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"FungsiMaju\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"FungsiMaju\"] = factory();\n\telse\n\t\troot[\"FungsiMaju\"] = factory();\n})(this, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","class Component {\n  name = null;\n  engine = null;\n  constructor(name) {\n    this.name = name;\n  }\n}\n\nexport default Component;","/* \n * Repo URL    : https://github.com/ai/nanoevents\n * License URL : https://github.com/ai/nanoevents/blob/main/LICENSE\n * \n * The MIT License (MIT)\n * \n * Copyright 2016 Andrey Sitnik <andrey@sitnik.ru>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy of\n * this software and associated documentation files (the \"Software\"), to deal in\n * the Software without restriction, including without limitation the rights to\n * use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\n * the Software, and to permit persons to whom the Software is furnished to do so,\n * subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\n * FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\n * COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\n * IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\n * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n */\n\nclass Emitter {\n  constructor(events) {\n    this.events = events;\n  }\n\n  /**\n   * Add a listener for a given event.\n   *\n   * ```js\n   * const unbind = ee.on('tick', (tickType, tickDuration) => {\n   *   count += 1\n   * })\n   *\n   * disable () {\n   *   unbind()\n   * }\n   * ```\n   *\n   * @param event The event name.\n   * @param cb The listener function.\n   * @returns Unbind listener from event.\n   */\n  on(event, cb) {\n    ; (this.events[event] = this.events[event] || []).push(cb)\n    return () =>\n      (this.events[event] = (this.events[event] || []).filter(i => i !== cb))\n  }\n\n  /**\n   * Calls each of the listeners registered for a given event.\n   *\n   * ```js\n   * ee.emit('tick', tickType, tickDuration)\n   * ```\n   *\n   * @param event The event name.\n   * @param args The arguments for listeners.\n   */\n  emit(event, ...args) {\n    ; (this.events[event] || []).forEach(i => i(...args))\n  }\n}\n\nexport default Emitter;","/* \n * Deteksi Pengulangan\n * Ref: https://github.com/retejs/rete/blob/master/src/engine/recursion.ts\n */\n\nconst intersect = (array1, array2) => {\n  return array1.filter(value => array2.indexOf(value) !== -1);\n}\n\nclass Recursion {\n  constructor(nodes) {\n    this.nodes = nodes;\n  }\n\n  extractInputNode(targetNode) {\n    return this.nodes.filter(node => {\n      if (node.outputs.length < 1) return false;\n      return node.outputs\n        .reduce((acc, n) => {\n          if (Array.isArray(n)) return [...acc, ...n]\n          return acc;\n        })\n        .indexOf(targetNode.id) !== -1;\n    });\n  }\n\n  findSelf(nodes, inputNodes) {\n    const inters = intersect(nodes, inputNodes);\n\n    if (inters.length)\n      return inters[0];\n\n    for (let node of inputNodes) {\n      let l = [node, ...nodes];\n      let inter = this.findSelf(l, this.extractInputNode(node));\n      if (inter)\n        return inter;\n    }\n\n    return null;\n  }\n\n  detect() {\n\n    let nodes = this.nodes;\n\n    for (let node of nodes) {\n      const inters = this.findSelf([node], this.extractInputNode(node));\n\n      if (inters)\n        return inters;\n    }\n\n    return null;\n  }\n}\n\nexport default Recursion;","import Component from './Component';\nimport Emitter from './Emitter';\nimport Recursion from './Recursion';\n\nconst events = {\n  process: [],\n  nodeselected: [],\n  nodecreate: [],\n  nodecreated: [],\n  noderemove: [],\n  noderemoved: [],\n  nodetranslated: [],\n  connectionselected: [],\n  connectioncreated: [],\n  connectionremoved: [],\n  contextmenu: [],\n};\n\nclass Engine extends Emitter {\n  version = null;\n  components = {};\n  nodes = null;\n\n  constructor(version) {\n    super(events);\n    this.version = version;\n  }\n\n  /**\n   * Register your custom component\n   *\n   * ```js\n   * e.register(new MyComponent());\n   * ```\n   *\n   * @param component The event name.\n   */\n  register(component) {\n    if (!(component instanceof Component)) throw new Error(\"Not Valid Component\");\n    if (!component.name) throw new Error(`Property name is \\`${component.name}\\``);\n\n    component.engine = this;\n\n    this.components[component.name] = component;\n\n    return this;\n  }\n\n  validate(data) {\n    if (typeof data !== \"object\") return false;\n    if (data.version !== this.version) throw new Error(\"Version not compatible\");\n    if (!Array.isArray(data.nodes)) return false;\n\n    const recursion = new Recursion(data.nodes);\n    const recurrentNode = recursion.detect();\n\n    if (recurrentNode)\n      throw new Error(`Recursion detected at \\`${recurrentNode.id}\\``)\n\n    return true;\n  }\n\n  forwardProcess(node, input) {\n    if (input === undefined) return false;\n    const component = this.components[node.type];\n    let output = component.worker(node, input);\n\n    return node.outputs.reduce((_, outputNodeIds, idx) => {\n      let nextInput = output;\n      if (Array.isArray(output)) nextInput = output[idx];\n      return outputNodeIds.reduce((_, nodeId) => {\n        const nextNode = this.nodes.find(node => node.id === nodeId);\n        return this.forwardProcess(nextNode, nextInput);\n      }, true);\n    }, true);\n  }\n\n  /**\n   * Process data based on json\n   *\n   * ```js\n   * e.process(input, startId, json = null);\n   * ```\n   *\n   * @param input Input value.\n   * @param startId Node id.\n   * @param json Flow process.\n   */\n  process(input, startId, json = null) {\n    if (!json) json = { version: this.version, nodes: this.nodes };\n\n    if (this.validate(json))\n      this.nodes = [...json.nodes];\n    else return false;\n\n    let node = this.nodes.find(node => node.id === startId);\n    this.forwardProcess(node, input);\n\n    this.emit(\"process\", node);\n\n    return true;\n  }\n}\n\nexport default Engine;","class Node {\n  metadata = {};\n  position = [0, 0];\n  constructor(id, type, outputs = [], options = {}) {\n    this.id = id;\n    this.type = type;\n    this.outputs = outputs;\n\n    if (options.position) this.position = options.position;\n    if (options.metadata) this.metadata = options.metadata;\n  }\n\n  setData(key, value) {\n    this.metadata[key] = value;\n    return this.metadata;\n  }\n\n  getData(key) {\n    return this.metadata[key];\n  }\n\n  removeData(key) {\n    delete this.metadata[key];\n    return this.metadata;\n  }\n\n  addOutput(branch, id) {\n\n    if (!this.outputs[branch])\n      this.outputs[branch] = [];\n\n    if (id\n      && this.outputs[branch].indexOf(id) === -1\n    ) {\n      this.outputs[branch].push(id);\n    }\n\n    return this;\n  }\n\n  removeOutput(id, branch = null) {\n    let result = [];\n\n    if (branch) result = this.outputs[branch].filter(output => output !== id);\n    else result = this.outputs.map(output => output.filter(out => out !== id));\n\n    this.outputs = result;\n\n    return this;\n  }\n\n  toJSON(complete = false) {\n    let data = {\n      id: this.id,\n      type: this.type,\n      metadata: this.metadata,\n      outputs: [...this.outputs.map(output => [...output])]\n    };\n\n    if (complete) data.position = [...this.position];\n\n    return data;\n  }\n}\n\nexport default Node;","class Drag {\n  constructor(element, onTranslate, onStart, onStop = () => { }, hotkey = null) {\n    this.pointerStart = null;\n    this.onTranslate = onTranslate;\n    this.onStart = onStart;\n    this.onStop = onStop;\n\n    this.down = this.down.bind(this);\n    this.keyDown = this.keyDown.bind(this, hotkey);\n    this.keyUp = this.keyUp.bind(this, hotkey);\n    this.move = this.move.bind(this);\n    this.up = this.up.bind(this);\n\n    this.element = element;\n    this.element.removeEventListener(\"pointerdown\", this.down);\n    this.element.addEventListener(\"pointerdown\", this.down);\n\n    this.keypress = null;\n\n    if (hotkey) {\n      this.keypress = false;\n      window.removeEventListener(\"keydown\", this.keyDown);\n      window.removeEventListener(\"keyup\", this.keyUp);\n      window.addEventListener(\"keydown\", this.keyDown);\n      window.addEventListener(\"keyup\", this.keyUp);\n    }\n\n    window.removeEventListener(\"pointermove\", this.move);\n    window.removeEventListener(\"pointerup\", this.up);\n    window.addEventListener(\"pointermove\", this.move);\n    window.addEventListener(\"pointerup\", this.up);\n  }\n\n  keyDown(hotkey, event) {\n    if (event.code === hotkey || event.key === hotkey) {\n      this.element.style.cursor = \"grab\";\n      this.keypress = true;\n    }\n  }\n  keyUp(hotkey, event) {\n    if (event.code === hotkey || event.key === hotkey) {\n      this.element.style.cursor = \"crosshair\";\n      this.keypress = false;\n    }\n  }\n\n  down(event) {\n    if (this.keypress !== null && this.keypress === false) return;\n    if (event.pointerType === \"mouse\")\n      event.stopPropagation();\n    this.pointerStart = [event.pageX, event.pageY];\n    this.onStart(event);\n  }\n\n  move(event) {\n    if (!this.pointerStart) return;\n    event.preventDefault();\n\n    let [x, y] = [event.pageX, event.pageY];\n\n    let delta = [x - this.pointerStart[0], y - this.pointerStart[1]];\n\n    let zoom = this.element.getBoundingClientRect().width / this.element.offsetWidth;\n\n    this.onTranslate(delta[0] / zoom, delta[1] / zoom, event);\n  }\n\n  up(event) {\n    if (!this.pointerStart) return;\n    this.pointerStart = null;\n    this.onStop(event);\n  }\n}\n\nexport default Drag;","// import '../css/View.css';\nimport Drag from \"./Drag\";\n\nclass Area {\n  constructor(container) {\n    this.mouse = { x: 0, y: 0 };\n\n    this.element = document.createElement(\"div\");\n    this.container = container;\n\n    this.element.style.transformOrigin = \"0 0\";\n\n    this.background = document.createElement(\"div\");\n    this.background.className = \"node-editor-background\";\n    this.background.style.zIndex = -1;\n\n    this.container.appendChild(this.element);\n    this.element.appendChild(this.background);\n\n    this.container.addEventListener('pointermove', this.pointermove.bind(this));\n\n    this._drag = new Drag(\n      this.container,\n      this.onTranslate.bind(this),\n      this.onStart.bind(this),\n      () => { },\n      \"Space\"\n    );\n\n    this.transform = {\n      x: 0, y: 0, z: 1\n    }\n\n    this.update();\n  }\n\n  pointermove(event) {\n    const { clientX, clientY } = event;\n    const rect = this.element.getBoundingClientRect();\n    const x = clientX - rect.left;\n    const y = clientY - rect.top;\n    const { z } = this.transform;\n    this.mouse = { x: x / z, y: y / z };\n  }\n\n  onStart(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    this._startPosition = { ...this.transform };\n  }\n\n  onTranslate(dx, dy) {\n    // if (this._zoom.translating) return; // lock translation while zoom on multitouch\n    if (this._startPosition) this.translate(this._startPosition.x + dx, this._startPosition.y + dy);\n  }\n\n  update() {\n    const tf = this.transform;\n    this.element.style.transform = `translate(${tf.x}px, ${tf.y}px) scale(${tf.z})`;\n  }\n\n  translate(x, y) {\n    this.transform.x = x\n    this.transform.y = y\n    this.update();\n  }\n\n  contains(element) {\n    return this.element.contains(element);\n  }\n  appendChild(element) {\n    return this.element.appendChild(element);\n  }\n  removeChild(element) {\n    return this.element.removeChild(element);\n  }\n}\n\nexport default Area;","class Connection {\n\n  static defaultPath(points) {\n    const [x1, y1, x2, y2] = points;\n    let dx1 = ((x1 + x2) / 2);\n    dx1 = dx1 - (dx1 - x1);\n    const dy1 = (y1 + y2) / 2;\n    let dx2 = (x1 + x2) / 2;\n    dx2 = dx2 + (dx2 - x1);\n    const dy2 = (y1 + y2) / 2;\n    return `M ${x1} ${y1} C ${dx1} ${dy1} ${dx2} ${dy2} ${x2} ${y2}`;\n  }\n\n  static renderPathData(points) {\n    return Connection.defaultPath(points);\n  }\n\n  static updateConnection(element, data, path = null) {\n    if (!path) path = element.querySelector(\".connection .main-path\");\n\n    if (!path) throw new Error(\"Path of connection was broken\");\n\n    const paths = path.querySelectorAll(\"path\");\n\n    paths.forEach((p)=> {\n      p.setAttribute(\"d\", data);\n    })\n\n  }\n\n  static renderConnection(element, data, connection) {\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n    const path = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n    const path_l = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n    const path_ol = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n    const path_bg = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n\n    const classes = !connection ? [] : [\n      `input-${connection.inputId}`,\n      `output-${connection.outputId}`\n    ];\n\n    if (classes.length > 0) svg.classList.add(\"connection\", ...classes);\n    else svg.classList.add(\"connection\");\n    path.classList.add(\"main-path\");\n    path_l.classList.add(\"main-path-l\");\n    path_ol.classList.add(\"main-path-ol\");\n    path_bg.classList.add(\"main-path-bg\");\n\n    path_bg.style.pointerEvents = \"all\";\n\n    path_l.setAttribute(\"d\", data);\n    path_ol.setAttribute(\"d\", data);\n    path_bg.setAttribute(\"d\", data);\n\n    path.appendChild(path_bg);\n    path.appendChild(path_ol);\n    path.appendChild(path_l);\n    svg.appendChild(path);\n    element.appendChild(svg);\n    return path;\n  }\n\n  constructor(view, outputSocket, inputSocket, emitter) {\n    this.view = view;\n    this.inputSocket = inputSocket;\n    this.outputSocket = outputSocket;\n    this.emitter = emitter;\n\n    this.inputSocket.addConnection(this);\n    this.outputSocket.addConnection(this);\n\n    this.element = document.createElement(\"div\");\n    this.element.style.position = \"absolute\";\n    this.element.style.zIndex = -1;\n    this.element.style.pointerEvents = \"none\";\n\n    this.keyup = this.keyup.bind(this);\n\n    this._path = null;\n\n    this.view.area.appendChild(this.element);\n\n    this.render();\n    this.emitter.emit(\"connectioncreated\", this);\n    this.emitter.on(\"connectionselected\", (self) => {\n      if (self !== this) return;\n      const vm = this;\n      window.addEventListener(\"click\", function listener(e) {\n        window.removeEventListener(\"click\", listener);\n        vm.click(e);\n      });\n    })\n  }\n\n  getPoints() {\n    const [x1, y1] = this.outputSocket.getPosition();\n    const [x2, y2] = this.inputSocket.getPosition();\n    return [x1, y1, x2, y2];\n  }\n\n  update() {\n    const d = Connection.renderPathData(this.getPoints());\n    Connection.updateConnection(this.element, d, this._path);\n  }\n\n  render() {\n    const d = Connection.renderPathData(this.getPoints());\n    this._path = Connection.renderConnection(\n      this.element, d,\n      {\n        inputId: this.inputSocket.nodeView.node.id,\n        outputId: this.outputSocket.nodeView.node.id\n      }\n    );\n\n    this._path.removeEventListener(\"click\", this.click.bind(this));\n    this._path.addEventListener(\"click\", this.click.bind(this));\n  }\n\n  click(e) {\n    const classList = this._path.classList;\n    window.removeEventListener(\"keyup\", this.keyup);\n    if (!classList.contains(\"active\")) {\n      e.stopPropagation();\n      window.addEventListener(\"keyup\", this.keyup);\n      this.emitter.emit(\"connectionselected\", this);\n    }\n    classList.toggle(\"active\");\n  }\n\n  keyup(e) {\n    if (e.code === \"Delete\" || e.code === \"Backspace\") {\n      this.destroy();\n    }\n  }\n\n  destroy() {\n    window.removeEventListener(\"keyup\", this.keyup);\n    this.inputSocket.removeConnection(this);\n    this.outputSocket.removeConnection(this);\n    this.view.removeConnection(this);\n    this.emitter.emit(\"connectionremoved\", this);\n  }\n}\n\nexport default Connection;","class Socket {\n  constructor(element, branch, type, nodeView) {\n    this.element = element;\n    this.branch = branch;\n    this.type = type;\n    this.nodeView = nodeView;\n\n    this.connection = [];\n\n    this.element.removeEventListener(\"pointerdown\", this.pointerdown.bind(this))\n    this.element.addEventListener(\"pointerdown\", this.pointerdown.bind(this));\n\n    this._pick = false;\n  }\n\n  action(socket) {\n    const { picker } = this.nodeView.view;\n    if (!socket) {\n      picker.reset();\n      return false;\n    }\n    if (socket.type === \"input\")\n      picker.pickInput(this);\n    else if (socket.type === \"output\") {\n      picker.pickOutput(this);\n    }\n  }\n\n  pointerdown(e) {\n    this.nodeView.view.container.dispatchEvent(new PointerEvent(\"mousemove\", e));\n    this.action(this);\n    e.preventDefault();\n    e.stopPropagation();\n  }\n\n  hasConnection(socket) {\n    const exist = this.connection\n      .find(conn => (\n        conn.inputSocket === socket || conn.outputSocket === socket\n      ))\n    return socket\n      ? !!exist\n      : this.connection.length > 0\n      ;\n  }\n\n  addConnection(connection) {\n    this.connection.push(connection);\n  }\n\n  removeConnection(connection = null) {\n    if (connection === null) {\n      const connection = [...this.connection];\n      return connection.map(conn => {\n        this.removeConnection(conn);\n        conn.destroy();\n        return conn;\n      });\n    } else {\n      const index = this.connection.indexOf(connection);\n      const conn = this.connection.splice(index, 1);\n      return conn[0];\n    }\n  }\n\n  getPosition() {\n    const el = this.element;\n    const { node } = this.nodeView;\n    const center = {\n      x: el.offsetWidth / 2,\n      y: el.offsetHeight / 2,\n    }\n    return [\n      node.position[0] + el.offsetLeft + center.x,\n      node.position[1] + el.offsetTop + center.y\n    ]\n  }\n\n  destroy() {\n    this.removeConnection();\n  }\n}\n\nexport default Socket;","class Element {\n  sockets = {\n    input: {},\n    output: {},\n  };\n\n  constructor(nodeView, name) {\n    this.nodeView = nodeView;\n    this.element = document.createElement(\"div\");\n    this.content = document.createElement(\"div\");\n    this.input = document.createElement(\"div\");\n    this.output = document.createElement(\"div\");\n\n    this.element.setAttribute(\"class\", \"node\");\n    this.input.setAttribute(\"class\", \"node-input\");\n    this.output.setAttribute(\"class\", \"node-output\");\n    this.content.setAttribute(\"class\", \"node-content\");\n\n    this.content.innerHTML = name || \"\";\n\n    this.element.appendChild(this.content);\n    this.element.appendChild(this.input);\n    this.element.appendChild(this.output);\n  }\n\n  addSocket(type, branch, name) {\n    const element = document.createElement(\"div\");\n    element.setAttribute(\"class\", `node-socket-${branch}`);\n    const content = document.createElement(\"div\");\n    element.appendChild(content);\n    content.innerHTML = name || branch;\n\n    const socket = {\n      name, element\n    }\n\n    if (type === \"input\" || type === \"output\")\n      this.sockets[type][branch] = socket;\n\n    return socket;\n  }\n\n  render(view, node) {\n    if (!!view.selected[node.id]) this.element.classList.add(\"selected\");\n    else this.element.classList.remove(\"selected\");\n\n    const types = Object.keys(this.sockets);\n    for (let type of types) {\n      const sockets = Object.keys(this.sockets[type]);\n\n      for (let key of sockets) {\n        const socket = this.sockets[type][key];\n\n        switch (type) {\n          case \"input\":\n            this.input.appendChild(socket.element);\n            break;\n          case \"output\":\n            this.output.appendChild(socket.element);\n            break;\n          default: break;\n        }\n      }\n    }\n    return this.element;\n  }\n}\n\nexport default Element;","// import '../css/View.css';\n\nimport Drag from \"./Drag\";\nimport Socket from \"./Socket\";\nimport Element from \"./Element\";\n\nclass Node {\n\n  constructor(node, component, view) {\n    this.view = view;\n    this.node = node;\n\n    this.sockets = {};\n\n    this.component = component;\n    this.container = document.createElement(\"div\");\n    this.container.style.position = \"absolute\";\n\n    this.container.className = \"node-wrapper\";\n\n    this.element = new Element(this, this.component.name);\n\n    this.container.addEventListener(\"contextmenu\", e => this.view.emitter.emit(\"contextmenu\", { e, node: this }));\n\n    this._drag = new Drag(\n      this.container,\n      this.onTranslate.bind(this),\n      this.onStart.bind(this),\n    );\n\n    this.update();\n    this.render();\n  }\n\n  get id() {\n    return this.node.id;\n  }\n\n  getElement() {\n    return this.element.element;\n  }\n\n  addSocket(type, key, name) {\n    const socket = this.element.addSocket(type, key, name);\n    this.sockets[`${type}-${key}`] = new Socket(socket.element, key, type, this);\n    if (type === \"output\") this.node.addOutput(key);\n    this.update();\n    this.view.rerenderNode();\n    return socket;\n  }\n\n  getSocket(type, key) {\n    const socket = this.sockets[`${type}-${key}`];\n    if (!socket) throw new Error(`Socket ${type} ${key} at node \\`${this.id}\\` not found.`);\n    return socket;\n  }\n\n  onStart(_e) {\n    this.view.selectNode(this, _e.ctrlKey);\n    this._startPosition = [...this.node.position];\n  }\n\n  onTranslate(dx, dy) {\n    const x = this._startPosition[0] + dx;\n    const y = this._startPosition[1] + dy;\n    this.translate(x, y);\n\n    this.view.emitter.emit(\"nodetranslated\", this.node);\n  }\n\n  onDrag(dx, dy) {\n    const x = this._startPosition[0] + dx;\n    const y = this._startPosition[1] + dy;\n    this.translate(x, y);\n  }\n\n  translate(x, y) {\n    const node = this.node;\n    const params = { node, x, y };\n    const grid = 5;\n\n    node.position[0] = Math.floor(params.x / grid) * grid;\n    node.position[1] = Math.floor(params.y / grid) * grid;\n\n    this.update();\n  }\n\n  update() {\n    let [x, y] = [0, 0];\n    if (this.node.position) [x, y] = this.node.position;\n    this.container.style.transform = `translate(${x}px, ${y}px)`;\n    this.node.position = [x, y];\n    this.view.updateConnection();\n  }\n\n  render() {\n    const el = this.element.render(this.view, this.node);\n    this.container.appendChild(el);\n  }\n\n  toJSON() {\n    return this.node.toJSON(true);\n  }\n\n  destroy() {\n    const sockets = this.sockets;\n    Object.keys(sockets)\n      .forEach((key) => {\n        const socket = this.sockets[key];\n        socket.destroy();\n      });\n    this.view.area.removeChild(this.container);\n  }\n}\n\nexport default Node;","import Connection from \"./Connection\";\n\nclass Picker {\n  constructor(view) {\n    this.view = view;\n\n    this.element = document.createElement(\"div\");\n    this.element.style.position = \"absolute\";\n    this.element.classList.add(\"node-picker\");\n    this.view.area.appendChild(this.element);\n\n    this._socket = null;\n\n    this.view.container.addEventListener(\"pointermove\", () => (\n      this.socket && this.updateConnection(this.socket)\n    ))\n\n    this.pointerup = this.pointerup.bind(this);\n\n    window.removeEventListener(\"pointerup\", this.pointerup);\n    window.addEventListener(\"pointerup\", this.pointerup);\n  }\n\n  get socket() {\n    return this._socket;\n  }\n\n  set socket(socket) {\n    this._socket = socket;\n    this.updatePseudoConnection(socket);\n    return socket;\n  }\n\n  reset() {\n    this.socket = null;\n  }\n\n  pointerup(event) {\n    const endEl = document.elementFromPoint(event.clientX, event.clientY);\n    if (!this.view.container.contains(endEl)) {\n      this.reset();\n      return false;\n    }\n\n    const sockets = this.view.getSockets();\n    const socket = sockets.find(socket => socket.element === endEl);\n\n    if (!this.socket || !socket) {\n      this.reset();\n      return false;\n    }\n    if (socket) socket.action(socket);\n  }\n\n  pickOutput(socket) {\n    if (this.socket === null && socket) {\n      this.socket = socket;\n      return true;\n    }\n\n    if (this.socket.type === \"input\") {\n      if (\n        !this.socket.hasConnection(socket)\n        && this.socket.nodeView !== socket.nodeView\n      ) {\n        this.view.connect(socket, this.socket);\n      }\n      this.reset();\n      return true;\n    }\n\n    if (socket) this.socket = socket;\n  }\n\n  pickInput(socket) {\n    if (this.socket === null) {\n      this.socket = socket;\n      return true;\n    }\n\n    if (this.socket.type === \"output\") {\n      if (\n        !this.socket.hasConnection(socket)\n        && this.socket.nodeView !== socket.nodeView\n      ) {\n        this.view.connect(this.socket, socket);\n      }\n      this.reset();\n      return true;\n    }\n    if (socket) this.socket = socket;\n  }\n\n  getPoints(socket) {\n    const mouse = this.view.area.mouse;\n    const [x1, y1] = socket.getPosition();\n    return socket.type === \"output\"\n      ? [x1, y1, mouse.x, mouse.y]\n      : [mouse.x, mouse.y, x1, y1]\n      ;\n  }\n\n  updatePseudoConnection(socket) {\n    if (socket !== null) {\n      this.renderConnection(socket);\n    } else {\n      this.element.innerHTML = \"\";\n    }\n  }\n\n  updateConnection(socket) {\n    const d = Connection.renderPathData(this.getPoints(socket));\n    Connection.updateConnection(this.element, d);\n  }\n\n  renderConnection(socket) {\n    const d = Connection.renderPathData(this.getPoints(socket));\n    Connection.renderConnection(this.element, d);\n  }\n\n}\n\nexport default Picker;","import Drag from \"./Drag\";\n\nclass Selection {\n  constructor(view) {\n    this.view = view;\n\n    this._drag = new Drag(\n      this.view.container,\n      this.onTranslate.bind(this),\n      this.onStart.bind(this),\n      this.onStop.bind(this)\n    )\n\n    this._startPosition = null;\n    this._endPosition = null;\n\n    this.element = document.createElement(\"div\");\n\n    this.element.style.position = \"absolute\";\n    this.element.style.zIndex = 2;\n    this.element.style.pointerEvents = \"none\";\n\n    this.view.area.appendChild(this.element);\n\n    this.render();\n  }\n\n  onStart(e) {\n    if (e.defaultPrevented) return false;\n    this.view.container.dispatchEvent(new PointerEvent(\"mousemove\", e));\n    const { x, y } = this.view.area.mouse;\n    this._startPosition = [x, y];\n    e.preventDefault();\n  }\n\n  onTranslate(dx, dy) {\n    if (this._startPosition === null) return false;\n    let x1 = this._startPosition[0] + dx;\n    let y1 = this._startPosition[1] + dy;\n    this._endPosition = [x1, y1];\n    this.update(x1, y1);\n  }\n\n  onStop(_e) {\n    if (this._startPosition === null || this._endPosition === null) return false;\n\n    let selection = [];\n    const direction = [\n      this._startPosition[0] >= this._endPosition[0],\n      this._startPosition[1] >= this._endPosition[1]\n    ]\n\n    if (direction[0] && direction[1]) {\n      selection = [\n        this._endPosition[0], this._endPosition[1],\n        this._startPosition[0], this._startPosition[1],\n      ];\n    } else if (direction[0] && !direction[1]) {\n      selection = [\n        this._endPosition[0],\n        this._startPosition[1],\n        this._endPosition[1],\n        this._startPosition[0],\n      ];\n    } else if (!direction[0] && direction[1]) {\n      selection = [\n        this._startPosition[0],\n        this._endPosition[1],\n        this._startPosition[1],\n        this._endPosition[0],\n      ];\n    } else {\n      selection = [\n        this._startPosition[0], this._startPosition[1],\n        this._endPosition[0], this._endPosition[1]\n      ];\n    }\n\n    const nodes = this.view.nodes;\n    for (const key of Object.keys(nodes)) {\n      const nodeView = nodes[key];\n      const node = nodes[key].node;\n      const el = nodeView.getElement();\n      const x = node.position[0];\n      const y = node.position[1];\n      const bounding = [x, y, x + el.clientWidth, y + el.clientHeight];\n      if (\n        selection[0] <= bounding[0]\n        && selection[1] <= bounding[1]\n        && selection[2] >= bounding[2]\n        && selection[3] >= bounding[3]\n      ) {\n        this.view.selectNode(nodeView, true);\n      }\n    }\n    this._startPosition = null;\n    this._endPosition = null;\n    this.update(0, 0);\n  }\n\n  renderPath(x2, y2) {\n    const [x1, y1] = this._startPosition;\n\n    return `M ${x1} ${y1} H ${x2} V ${y2} H ${x1} L ${x1} ${y1}`;\n  }\n\n  update(x, y) {\n    let d = \"\";\n    if (this._startPosition !== null) d = this.renderPath(x, y);\n    const rect = this.element.querySelector(\"svg path.node-selection-rect\");\n    rect.setAttribute(\"fill\", \"rgb(255 255 255 / 50%)\");\n    rect.setAttribute(\"stroke\", \"blue\");\n    rect.setAttribute(\"strokeWidth\", 2);\n    rect.setAttribute(\"d\", d);\n  };\n\n  render() {\n    const svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n    const rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n\n    rect.setAttribute(\"class\", \"node-selection-rect\");\n    svg.style.overflow = \"visible\";\n\n    svg.appendChild(rect);\n    this.element.appendChild(svg);\n  }\n}\n\nexport default Selection;","// import '../css/View.css';\nimport Area from \"./Area\";\nimport Connection from \"./Connection\";\nimport NodeView from \"./Node\";\nimport Picker from \"./Picker\";\nimport Selection from \"./Selection\";\n\nclass View {\n  constructor(container, components, emitter) {\n    this.emitter = emitter;\n\n    this.container = container;\n    this.components = components;\n\n    this.container.setAttribute(\"tabIndex\", 0);\n\n    this.container.classList.add(\"node-editor-container\");\n    this.container.addEventListener(\"pointerup\", this.click.bind(this));\n    this.container.addEventListener(\"contextmenu\", e => this.emitter.emit(\"contextmenu\", { e, view: this }));\n    this.container.style.cursor = \"crosshair\";\n\n    this.keyup = this.keyup.bind(this);\n\n    this.container.removeEventListener(\"keyup\", this.keyup);\n    this.container.addEventListener(\"keyup\", this.keyup);\n\n    this.container.addEventListener(\"focusout\", () => {\n      this.selected = {};\n      this.rerenderNode();\n    });\n\n    this.connection = {};\n    this.selected = {};\n    this.nodes = {};\n\n    this.area = new Area(this.container);\n    this.picker = new Picker(this);\n    this.selection = new Selection(this);\n\n    this.emitter.on(\"nodecreated\", (node) => {\n      this.addNode(node);\n    });\n    this.emitter.on(\"noderemove\", (node) => {\n      this.removeNode(this.nodes[node.id]);\n    });\n  }\n\n  addNode(node) {\n    const component = this.components[node.type];\n\n    if (!component) throw new Error(`Component ${node.name} not found`);\n\n    const nodeView = new NodeView(node, component, this);\n\n    this.nodes[node.id] = nodeView;\n    this.area.appendChild(nodeView.container);\n\n    component.builder(nodeView);\n\n    return nodeView;\n  }\n\n  selectNode(node, accumulate) {\n    if (node && !this.nodes[node.id])\n      throw new Error(\"Node not exist in list\");\n\n    if (!accumulate) this.selected = {};\n\n    if (this.selected[node.id])\n      delete this.selected[node.id];\n    else {\n      this.selected[node.id] = node;\n      this.container.focus();\n    }\n\n    this.emitter.emit(\"nodeselected\", node);\n\n    this.rerenderNode();\n  }\n\n  removeNode(node) {\n    const id = node.id;\n    const deletedNode = this.nodes[id].node;\n    this.nodes[id].destroy();\n    delete this.nodes[id];\n    return deletedNode;\n  }\n\n  getNode(id) {\n    return this.nodes[id];\n  }\n\n  addConnection(from, fromBranch, to, toBranch = 0) {\n    const fromNode = this.nodes[from.id];\n    const toNode = this.nodes[to.id];\n    const fromSocket = fromNode.getSocket(\"output\", fromBranch);\n    const toSocket = toNode.getSocket(\"input\", toBranch);\n\n    this.connect(fromSocket, toSocket);\n  }\n\n  removeConnection(connection) {\n    const connKey = Object.keys(this.connection).filter(key => this.connection[key] === connection);\n    this.area.removeChild(this.connection[connKey].element);\n    const from = connection.outputSocket.nodeView;\n    const to = connection.inputSocket.nodeView;\n    from.node.removeOutput(to.id);\n\n    delete this.connection[connKey];\n  }\n\n  connect(fromSocket, toSocket) {\n    const from = fromSocket.nodeView;\n    const to = toSocket.nodeView;\n    const id = `${from.id}_${fromSocket.branch}-${to.id}_${toSocket.branch}`;\n    from.node.addOutput(fromSocket.branch, to.id);\n    this.connection[id] = new Connection(this, fromSocket, toSocket, this.emitter);\n  }\n\n  getSockets() {\n    const sockets = Object.keys(this.nodes)\n      .map((key) => this.nodes[key].sockets)\n      .map((sockets) => Object.keys(sockets).map(key => sockets[key]))\n      .reduce((acc, sockets) => [...acc, ...sockets], []);\n    return sockets;\n  };\n\n  rerenderNode() {\n    Object.keys(this.nodes).forEach((key) => {\n      this.nodes[key].render();\n    });\n    this.updateConnection();\n  }\n\n  updateConnection() {\n    Object.keys(this.connection).forEach((key) => {\n      this.connection[key].update();\n    })\n  }\n\n  click(event) {\n    let collision = false;\n    Object.keys(this.nodes).forEach((key) => {\n      if (this.nodes[key].getElement().contains(event.target)) collision = true;\n    });\n    if (!collision) {\n      this.selected = {};\n      this.rerenderNode();\n    }\n  }\n\n  keyup(event) {\n    if (event.code === \"Backspace\" || event.code === \"Delete\") {\n      Object.keys(this.selected).forEach((key) => {\n        const node = this.selected[key];\n        this.emitter.removeNode(node.node);\n      })\n    }\n  }\n}\n\nexport default View;","import Engine from \"./Engine\";\nimport Node from \"./Node\";\nimport View from \"./View\";\n\nclass Editor extends Engine {\n  view = null;\n\n  static generateId() {\n    const rand = Math.random().toString(36);\n    return `${rand.substr(2, 4)}_${rand.substr(4, 4)}`;\n  };\n\n  constructor(version, container) {\n    super(version);\n    this.nodes = [];\n\n    if (container) this.view = new View(container, this.components, this);\n  }\n\n  addNode(node) {\n    this.emit(\"nodecreate\", node);\n\n    if (!node instanceof Node) return node;\n\n    if (!this.components.hasOwnProperty(node.type))\n      throw new Error(`Component ${node.type} not registered`);\n\n    this.nodes.push(node);\n\n    this.emit(\"nodecreated\", node, this.components[node.type]);\n\n    return node;\n  }\n\n  removeNode(node) {\n    if (Array.isArray(node)) {\n      return node.map((n) => {\n        return this.removeNode(n);\n      })\n    }\n\n    this.emit(\"noderemove\", node);\n\n    const index = this.nodes.findIndex(n => n.id === node.id);\n    if (index === -1) throw new Error(`Node ${node.id} not found`);\n\n    const nodes = this.nodes.splice(index, 1);\n\n    this.emit(\"noderemoved\", nodes);\n\n    return nodes[0];\n  }\n\n  getNode(id) {\n    return this.nodes.find((node) => node.id === id);\n  }\n\n  connect(from, branch, to) {\n    const fromNode = this.nodes.find(node => node.id === from.id);\n    if (!fromNode) throw new Error(`Node ${from.id} not found`);\n\n    const toNode = this.nodes.find(node => node.id === to.id);\n    if (!toNode) throw new Error(`Node ${to.id} not found`);\n\n    fromNode.addOutput(branch, toNode.id);\n\n    if (this.view) this.view.addConnection(fromNode, branch, toNode);\n\n    return this;\n  }\n\n  toJSON(complete = false) {\n    const data = {\n      version: this.version,\n      nodes: this.nodes.map((node) => node.toJSON(complete))\n    };\n    return data;\n  }\n\n  fromJSON(data) {\n    if (!this.validate(data)) return false;\n\n    const nodes = [...this.nodes];\n    nodes.forEach((node) => {\n      this.removeNode(node);\n    });\n\n    data.nodes\n      .map((node) => {\n        return this.addNode(new Node(node.id, node.type, node.outputs, {\n          position: node.position,\n          metadata: node.metadata\n        }));\n      }).forEach((node) => {\n        node.outputs.forEach((output, branch) => {\n          output.forEach((nodeId) => {\n            const toNode = this.getNode(nodeId);\n            this.connect(node, branch, toNode);\n          })\n        })\n      });\n\n    return true;\n  }\n}\n\nexport default Editor;","import \"./css/View.css\";\n\nimport Component from \"./Component\";\nimport Editor from \"./Editor\";\nimport Engine from \"./Engine\";\nimport Node from \"./Node\";\nimport Recursion from \"./Recursion\";\n\nimport View from \"./View\";\nimport Area from \"./View/Area\";\nimport Connection from \"./View/Connection\";\nimport Drag from \"./View/Drag\";\nimport Element from \"./View/Element\";\nimport NodeView from \"./View/Node\";\nimport Socket from \"./View/Socket\";\n\nexport { default as Component } from \"./Component\";\nexport { default as Editor } from \"./Editor\";\nexport { default as Engine } from \"./Engine\";\nexport { default as Node } from \"./Node\";\nexport { default as Recursion } from \"./Recursion\";\n\nexport { default as View } from \"./View\";\nexport { default as Area } from \"./View/Area\";\nexport { default as Connection } from \"./View/Connection\";\nexport { default as Drag } from \"./View/Drag\";\nexport { default as Element } from \"./View/Element\";\nexport { default as NodeView } from \"./View/Node\";\nexport { default as Socket } from \"./View/Socket\";\n\n// eslint-disable-next-line import/no-anonymous-default-export\nexport default {\n  Component,\n  Editor,\n  Engine,\n  Node,\n  Recursion,\n\n  View,\n  Area,\n  Connection,\n  Drag,\n  NodeView,\n  Element,\n  Socket,\n};"],"sourceRoot":""}