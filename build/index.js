/*!
 * 
 *   fungsi-maju v0.0.5
 *   https://github.com/ilomon10/fungsi-maju
 * 
 *   Copyright (c) Imanuel Pundoko (https://github.com/ilomon10)
 * 
 *   This source code is licensed under the MIT license found in the
 *   LICENSE file in the root directory of this source tree.
 *   
 */
!function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t():"function"===typeof define&&define.amd?define("FungsiMaju",[],t):"object"===typeof exports?exports.FungsiMaju=t():e.FungsiMaju=t()}(this,(function(){return function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,__webpack_require__),r.l=!0,r.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)__webpack_require__.d(n,r,function(t){return e[t]}.bind(null,r));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="/",__webpack_require__(__webpack_require__.s=0)}([function(e,t,n){"use strict";function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t),n.d(t,"Component",(function(){return r})),n.d(t,"Editor",(function(){return y})),n.d(t,"Engine",(function(){return i})),n.d(t,"Node",(function(){return a})),n.d(t,"Recursion",(function(){return o})),n.d(t,"View",(function(){return p})),n.d(t,"Area",(function(){return s})),n.d(t,"Connection",(function(){return c})),n.d(t,"Drag",(function(){return u})),n.d(t,"Element",(function(){return f})),n.d(t,"NodeView",(function(){return d})),n.d(t,"Socket",(function(){return l}));var r=function Component(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Component),_defineProperty(this,"name",null),_defineProperty(this,"engine",null),this.name=e};function _createForOfIteratorHelper(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,F=function(){};return{s:F,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function _toConsumableArray(e){return function(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"===typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function Recursion(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Recursion),this.nodes=e}var e,t,n;return e=Recursion,(t=[{key:"extractInputNode",value:function(e){return this.nodes.filter((function(t){return!(t.outputs.length<1)&&-1!==t.outputs.reduce((function(e,t){return Array.isArray(t)?[].concat(_toConsumableArray(e),_toConsumableArray(t)):e})).indexOf(e.id)}))}},{key:"findSelf",value:function(e,t){var n,r=(n=t,e.filter((function(e){return-1!==n.indexOf(e)})));if(r.length)return r[0];var o,i=_createForOfIteratorHelper(t);try{for(i.s();!(o=i.n()).done;){var a=o.value,u=[a].concat(_toConsumableArray(e)),s=this.findSelf(u,this.extractInputNode(a));if(s)return s}}catch(c){i.e(c)}finally{i.f()}return null}},{key:"detect",value:function(){var e,t=_createForOfIteratorHelper(this.nodes);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.findSelf([n],this.extractInputNode(n));if(r)return r}}catch(o){t.e(o)}finally{t.f()}return null}}])&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Recursion}();function Engine_toConsumableArray(e){return function(e){if(Array.isArray(e))return Engine_arrayLikeToArray(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return Engine_arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Engine_arrayLikeToArray(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Engine_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _typeof(e){return(_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Engine_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Engine_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i=function(){function Engine(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Engine),Engine_defineProperty(this,"version",null),Engine_defineProperty(this,"components",{}),Engine_defineProperty(this,"nodes",null),this.version=e}var e,t,n;return e=Engine,(t=[{key:"register",value:function(e){if(!(e instanceof r))throw new Error("Not Valid Component");if(!e.name)throw new Error("Property name is `".concat(e.name,"`"));return e.engine=this,this.components[e.name]=e,this}},{key:"validate",value:function(e){if("object"!==_typeof(e))return!1;if(e.version!==this.version)throw new Error("Version not compatible");if(!Array.isArray(e.nodes))return!1;var t=new o(e.nodes).detect();if(t)throw new Error("Recursion detected at `".concat(t.id,"`"));return!0}},{key:"forwardProcess",value:function(e,t){var n=this;if(void 0===t)return!1;var r=this.components[e.type].worker(e,t);return e.outputs.reduce((function(e,t,o){var i=r;return Array.isArray(r)&&(i=r[o]),t.reduce((function(e,t){var r=n.nodes.find((function(e){return e.id===t}));return n.forwardProcess(r,i)}),!0)}),!0)}},{key:"process",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n||(n={version:this.version,nodes:this.nodes}),!this.validate(n))return!1;this.nodes=Engine_toConsumableArray(n.nodes);var r=this.nodes.find((function(e){return e.id===t}));return this.forwardProcess(r,e),!0}}])&&Engine_defineProperties(e.prototype,t),n&&Engine_defineProperties(e,n),Engine}();function Node_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Node_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function Node(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];Node_classCallCheck(this,Node),this.id=e,this.type=t,this.outputs=n}var e,t,n;return e=Node,(t=[{key:"addOutput",value:function(e,t){return this.outputs[e]||(this.outputs[e]=[]),t&&this.outputs[e].push(t),this}},{key:"removeOutput",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];return n=t?this.outputs[t].filter((function(t){return t!==e})):this.outputs.map((function(t){return t.filter((function(t){return t!==e}))})),this.outputs=n,this}},{key:"toJSON",value:function(){return{id:this.id,type:this.type,outputs:this.outputs}}}])&&Node_defineProperties(e.prototype,t),n&&Node_defineProperties(e,n),Node}();function Drag_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Drag_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function Drag(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;Drag_classCallCheck(this,Drag),this.pointerStart=null,this.onTranslate=t,this.onStart=n,this.element=e,this.element.addEventListener("pointerdown",this.down.bind(this)),this.keypress=null,r&&(this.keypress=!1,window.addEventListener("keydown",this.keyDown.bind(this,r)),window.addEventListener("keyup",this.keyUp.bind(this,r))),window.addEventListener("pointermove",this.move.bind(this)),window.addEventListener("pointerup",this.up.bind(this))}var e,t,n;return e=Drag,(t=[{key:"keyDown",value:function(e,t){t.code!==e&&t.key!==e||(this.element.style.cursor="grab",this.keypress=!0)}},{key:"keyUp",value:function(e,t){t.code!==e&&t.key!==e||(this.element.style.cursor="crosshair",this.keypress=!1)}},{key:"down",value:function(e){null!==this.keypress&&!1===this.keypress||("mouse"===e.pointerType&&e.stopPropagation(),this.pointerStart=[e.pageX,e.pageY],this.onStart(e))}},{key:"move",value:function(e){if(this.pointerStart){e.preventDefault();var t=[e.pageX,e.pageY],n=t[1],r=[t[0]-this.pointerStart[0],n-this.pointerStart[1]],o=this.element.getBoundingClientRect().width/this.element.offsetWidth;this.onTranslate(r[0]/o,r[1]/o,e)}}},{key:"up",value:function(e){this.pointerStart&&(this.pointerStart=null)}}])&&Drag_defineProperties(e.prototype,t),n&&Drag_defineProperties(e,n),Drag}();function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Area_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Area_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var s=function(){function Area(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Area),this.element=document.createElement("div"),this.container=e,this.element.style.transformOrigin="0 0",this.background=document.createElement("div"),this.background.className="node-editor-background",this.element.appendChild(this.background),this._drag=new u(this.container,this.onTranslate.bind(this),this.onStart.bind(this),"Space"),this.transform={x:0,y:0,z:1},this.update()}var e,t,n;return e=Area,(t=[{key:"onStart",value:function(){this._startPosition=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){Area_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.transform)}},{key:"onTranslate",value:function(e,t){this._startPosition&&this.translate(this._startPosition.x+e,this._startPosition.y+t)}},{key:"update",value:function(){var e=this.transform;this.element.style.transform="translate(".concat(e.x,"px, ").concat(e.y,"px) scale(").concat(e.z,")")}},{key:"translate",value:function(e,t){this.transform.x=e,this.transform.y=t,this.update()}},{key:"appendChild",value:function(e){this.element.appendChild(e)}},{key:"removeChild",value:function(e){this.element.removeChild(e)}}])&&Area_defineProperties(e.prototype,t),n&&Area_defineProperties(e,n),Area}();function _slicedToArray(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,i=s}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Connection_arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Connection_arrayLikeToArray(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Connection_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Connection_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function Connection(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Connection),this.view=e,this.inputSocket=n,this.outputSocket=t,this.element=document.createElement("div"),this.element.style.position="absolute",this.element.style.zIndex=2,this.element.style.pointerEvents="none",this.render()}var e,t,n;return e=Connection,(t=[{key:"getPoints",value:function(){var e=_slicedToArray(this.outputSocket.getPosition(),2),t=e[0],n=e[1],r=_slicedToArray(this.inputSocket.getPosition(),2);return[t,n,r[0],r[1]]}},{key:"renderPath",value:function(){var e=_slicedToArray(this.getPoints(),4),t=e[0],n=e[1],r=e[2],o=e[3],i=(t+r)/2;i-=i-t;var a=(n+o)/2,u=(t+r)/2;u+=u-t;var s=(n+o)/2;return"M ".concat(t," ").concat(n," C ").concat(i," ").concat(a," ").concat(u," ").concat(s," ").concat(r," ").concat(o)}},{key:"update",value:function(){var e=this.element.querySelector(".connection path.main-path");if(!e)throw new Error("Path of connection was broken");var t=this.renderPath();e.setAttribute("d",t)}},{key:"render",value:function(){var e,t=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","path"),r=["input-".concat(this.inputSocket.nodeView.node.id),"output-".concat(this.outputSocket.nodeView.node.id)];(e=t.classList).add.apply(e,["connection"].concat(r)),n.classList.add("main-path"),t.appendChild(n),this.element.appendChild(t),this.view.area.appendChild(this.element),this.update()}}])&&Connection_defineProperties(e.prototype,t),n&&Connection_defineProperties(e,n),Connection}();function Socket_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function Socket(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Socket),this.element=e,this.type=t,this.nodeView=n}var e,t,n;return e=Socket,(t=[{key:"getPosition",value:function(){var e=this.element,t=this.nodeView.node,n=e.offsetWidth/2,r=e.offsetHeight/2;return[t.position[0]+e.offsetLeft+n,t.position[1]+e.offsetTop+r]}}])&&Socket_defineProperties(e.prototype,t),n&&Socket_defineProperties(e,n),Socket}();function Element_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Element_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var f=function(){function Element(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Element),Element_defineProperty(this,"input",{}),Element_defineProperty(this,"output",{}),this.nodeView=e,this.element=document.createElement("div")}var e,t,n;return e=Element,(t=[{key:"addSocket",value:function(e,t){var n=document.createElement("div");switch(n.setAttribute("class","node-socket node-socket-".concat(t)),e){case"input":this.input[t]=n;break;case"output":this.output[t]=n}return n}},{key:"render",value:function(){this.element.setAttribute("class","node");var e=document.createElement("div"),t=document.createElement("div"),n=document.createElement("div"),r=document.createElement("div");return t.setAttribute("class","node-input"),n.setAttribute("class","node-output"),r.setAttribute("class","node-socket"),this.element.appendChild(e),this.element.appendChild(t),this.element.appendChild(n),t.appendChild(r),n.appendChild(r),this.element}}])&&Element_defineProperties(e.prototype,t),n&&Element_defineProperties(e,n),Element}();function Node_slicedToArray(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,i=s}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(e,t)||Node_unsupportedIterableToArray(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Node_toConsumableArray(e){return function(e){if(Array.isArray(e))return Node_arrayLikeToArray(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Node_unsupportedIterableToArray(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Node_unsupportedIterableToArray(e,t){if(e){if("string"===typeof e)return Node_arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Node_arrayLikeToArray(e,t):void 0}}function Node_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function View_Node_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function Node(e,t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Node),this.view=n,this.node=e,this.sockets={},this.component=t,this.container=document.createElement("div"),this.container.style.position="absolute",this.container.className="node-wrapper",this.element=new f(this),this._drag=new u(this.container,this.onTranslate.bind(this),this.onStart.bind(this)),this.update(),this.render()}var e,t,n;return e=Node,(t=[{key:"addSocket",value:function(e,t){var n=this.element.addSocket(e,t);return this.sockets["".concat(e,"-").concat(t)]=new l(n,e,this),this}},{key:"onStart",value:function(e){this.view.selectNode(this.node),this._startPosition=Node_toConsumableArray(this.node.position)}},{key:"onTranslate",value:function(e,t){var n=this._startPosition[0]+e,r=this._startPosition[1]+t;this.translate(n,r)}},{key:"onDrag",value:function(e,t){var n=this._startPosition[0]+e,r=this._startPosition[1]+t;this.translate(n,r)}},{key:"translate",value:function(e,t){var n=this.node,r=e,o=t;n.position[0]=5*Math.floor(r/5),n.position[1]=5*Math.floor(o/5),this.update()}},{key:"update",value:function(){var e=0,t=0;if(this.node.position){var n=Node_slicedToArray(this.node.position,2);e=n[0],t=n[1]}this.container.style.transform="translate(".concat(e,"px, ").concat(t,"px)"),this.node.position=[e,t],this.view.rerenderNode()}},{key:"render",value:function(){console.log(this.element)}}])&&View_Node_defineProperties(e.prototype,t),n&&View_Node_defineProperties(e,n),Node}();function View_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function View(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,View),this.container=e,this.components=t,this.container.classList.add("node-editor-container"),this.container.addEventListener("click",this.click.bind(this)),this.area=new s(this.container),this.container.appendChild(this.area.element),this.connection={},this.selected={},this.nodes={}}var e,t,n;return e=View,(t=[{key:"addNode",value:function(e){var t=this.components[e.type];if(!t)throw new Error("Component ".concat(e.name," not found"));var n=new d(e,t,this);return this.nodes[e.id]=n,this.area.appendChild(n.container),n}},{key:"selectNode",value:function(e,t){if(e&&!this.nodes[e.id])throw new Error("Node not exist in list");t||(this.selected={}),this.selected[e.id]?delete this.selected[e.id]:this.selected[e.id]=e,this.rerenderNode()}},{key:"addConnection",value:function(e,t,n){var r=this.nodes[e.id],o=this.nodes[n.id],i=r.sockets["output-".concat(t)],a=o.sockets["input-0"];this.connection["".concat(e.id,"-").concat(n.id)]=new c(this,i,a)}},{key:"rerenderNode",value:function(){var e=this;Object.keys(this.nodes).forEach((function(t){e.nodes[t].render()})),Object.keys(this.connection).forEach((function(t){e.connection[t].update()}))}},{key:"click",value:function(e){var t=this,n=!1;Object.keys(this.nodes).forEach((function(r){t.nodes[r].element.contains(e.target)&&(n=!0)})),n||(this.selected={},this.rerenderNode())}}])&&View_defineProperties(e.prototype,t),n&&View_defineProperties(e,n),View}();function Editor_typeof(e){return(Editor_typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Editor_defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Editor_createClass(e,t,n){return t&&Editor_defineProperties(e.prototype,t),n&&Editor_defineProperties(e,n),e}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!==Editor_typeof(t)&&"function"!==typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(Editor,e);var t=_createSuper(Editor);function Editor(e,n){var r,o,i,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Editor),r=t.call(this,e),o=_assertThisInitialized(r),a=null,(i="view")in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,r.nodes=[],n&&(r.view=new p(n,r.components)),r}return Editor_createClass(Editor,null,[{key:"generateId",value:function(){var e=Math.random().toString(36);return"".concat(e.substr(2,4),"_").concat(e.substr(4,4))}}]),Editor_createClass(Editor,[{key:"addNode",value:function(e){if(!e instanceof a)return e;if(!this.components.hasOwnProperty(e.type))throw new Error("Component ".concat(e.type," not registered"));if(this.view){var t=this.view.addNode(e);this.components[e.type].builder(t)}return this.nodes.push(e),e}},{key:"removeNode",value:function(e){return this.nodes.filter((function(t){return t.id!==e}))}},{key:"connect",value:function(e,t,n){var r=this.nodes.find((function(t){return t.id===e.id}));if(!r)throw new Error("Node ".concat(e.id," not found"));var o=this.nodes.find((function(e){return e.id===n.id}));if(!o)throw new Error("Node ".concat(n.id," not found"));return this.view&&this.view.addConnection(r,t,o),r.addOutput(t,o.id),this}},{key:"toJSON",value:function(){return{version:this.version,nodes:this.nodes.map((function(e){return e.toJSON()}))}}}]),Editor}(i);t.default={Component:r,Editor:y,Engine:i,Node:a,Recursion:o,View:p,Area:s,Connection:c,Drag:u,NodeView:d,Element:f,Socket:l}}])}));
//# sourceMappingURL=index.js.map